$(window).on("load",function(){var t=d3.select("#focus-context"),a=10,e=10,n=100,r=40,d=430,i=20,s=40,l=t.node().getBoundingClientRect().width-r-e,c=500-a-n;height2=500-d-i;var o=d3.time.format("%b %Y").parse,p=d3.time.scale().range([0,l]),g=d3.time.scale().range([0,l]),u=d3.scale.linear().range([c,0]),h=d3.scale.linear().range([height2,0]),f=d3.svg.axis().scale(p).orient("bottom"),m=d3.svg.axis().scale(g).orient("bottom"),x=d3.svg.axis().scale(u).orient("left"),v=d3.svg.brush().x(g).on("brush",function(){p.domain(v.empty()?g.domain():v.extent()),A.select(".d3-area").attr("d",w),A.select("d3-xaxis").call(f)}),w=d3.svg.area().interpolate("monotone").x(function(t){return p(t.date)}).y0(c).y1(function(t){return u(t.price)}),y=d3.svg.area().interpolate("monotone").x(function(t){return g(t.date)}).y0(height2).y1(function(t){return h(t.price)}),b=t.append("svg"),C=b.attr("width",l+r+e).attr("height",c+a+n);C.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",l).attr("height",c);var A=C.append("g").attr("class","focus").attr("transform","translate("+r+","+a+")"),B=C.append("g").attr("class","context").attr("transform","translate("+s+","+d+")");function R(){l=t.node().getBoundingClientRect().width-r-e,b.attr("width",l+r+e),C.attr("width",l+r+e),p.range([0,l]),g.range([0,l]),C.selectAll(".d3-xaxis").call(f),C.selectAll(".d3-focus-area").attr("d",w),C.selectAll(".d3-context-area").attr("d",y)}d3.csv("../../../app-assets/data/d3/line/focus-context.csv",function(t){return t.date=o(t.date),t.price=+t.price,t},function(t,a){if(t)throw t;p.domain(d3.extent(a.map(function(t){return t.date}))),u.domain([0,d3.max(a.map(function(t){return t.price}))]),g.domain(p.domain()),h.domain(u.domain()),A.append("path").datum(a).attr("class","d3-area d3-focus-area").attr("d",w).style("fill","#5C6BC0"),A.append("g").attr("class","d3-axis d3-xaxis").attr("transform","translate(0,"+c+")").call(f),A.append("g").attr("class","d3-axis d3-yaxis").call(x),B.append("path").datum(a).attr("class","d3-area d3-context-area").attr("d",y).style("fill","#5C6BC0"),B.append("g").attr("class","d3-axis d3-xaxis").attr("transform","translate(0,"+height2+")").call(m),B.append("g").attr("class","d3-xbrush").call(v).selectAll("rect").attr("y",-6).attr("height",height2+7).style("fill-opacity",".225")}),$(window).on("resize",R),$(".menu-toggle").on("click",R)});