$(window).on("load",function(){var s,f=d3.select("#collapsible-tree"),u={top:20,right:20,bottom:30,left:50},h=f.node().getBoundingClientRect().width-u.left-u.right,y=600-u.top-u.bottom,p=0,g=f.append("svg"),x=g.attr("width",h+u.left+u.right).attr("height",y+u.top+u.bottom).append("g").attr("transform","translate("+u.left+","+u.top+")"),v=d3.layout.tree().size([y,h-180]),m=d3.svg.diagonal().projection(function(t){return[t.y,t.x]});function k(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null)}d3.json("../../../app-assets/data/d3/tree/collapsible-tree.json",function(t,e){(s=e).x0=y/2,s.y0=0,s.children.forEach(function t(e){e.children&&(e.children.forEach(t),k(e))}),k(s.children[1]),k(s.children[1].children[2]),k(s.children[9]),k(s.children[9].children[0]),function e(n){var t=d3.event&&d3.event.altKey?5e3:500;var r=v.nodes(s).reverse();var i=x.selectAll(".d3-tree-node").data(r,function(t){return t.id||(t.id=++p)});var l=i.enter().append("g").attr("class","d3-tree-node").attr("transform",function(t){return"translate("+n.y0+","+n.x0+")"}).on("click",function(t){k(t),e(t)});l.append("circle").attr("r",1e-6).style("fill","#fff").style("stroke","#E84A5F").style("stroke-width",1.5).style("cursor","pointer").style("fill",function(t){return t._children?"#E84A5F":"#fff"});l.append("text").attr("x",function(t){return t.children||t._children?-10:10}).attr("dy",".35em").style("text-anchor",function(t){return t.children||t._children?"end":"start"}).style("font-size",12).style("fill-opacity",1e-6).text(function(t){return t.name});var o=i.transition().duration(t).attr("transform",function(t){return"translate("+t.y+","+t.x+")"});o.select("circle").attr("r",4.5).style("fill",function(t){return t._children?"#E84A5F":"#fff"});o.select("text").style("fill-opacity",1);var a=i.exit().transition().duration(t).attr("transform",function(t){return"translate("+n.y+","+n.x+")"}).remove();a.select("circle").attr("r",1e-6);a.select("text").style("fill-opacity",1e-6);var c=x.selectAll(".d3-tree-link").data(v.links(r),function(t){return t.target.id});c.enter().insert("path","g").attr("class","d3-tree-link").style("fill","none").style("stroke","#e3e3e3").style("stroke-width",1.5).attr("d",function(t){var e={x:n.x0,y:n.y0};return m({source:e,target:e})}).transition().duration(t).attr("d",m);c.transition().duration(t).attr("d",m);c.exit().transition().duration(t).attr("d",function(t){var e={x:n.x,y:n.y};return m({source:e,target:e})}).remove();r.forEach(function(t){t.x0=t.x,t.y0=t.y});$(window).on("resize",d);$(".menu-toggle, .d3-tree-node circle").on("click",d);function d(){h=f.node().getBoundingClientRect().width-u.left-u.right,r=v.nodes(s),links=v.links(r),g.attr("width",h+u.left+u.right),x.attr("width",h+u.left+u.right),v.size([y,h-180]),m.projection(function(t){return[t.y,t.x]}),x.selectAll(".d3-tree-link").attr("d",m),x.selectAll(".d3-tree-node").attr("transform",function(t){return"translate("+t.y+","+t.x+")"})}}(s)})});