$(window).on("load",function(){var d=d3.select("#nested-donut"),t=20,s=10,l=10,e=300;radius=(Math.min(e,300)-2*t)/2;var u=d3.scale.ordinal().range(["#99B898","#FECEA8","#FF847C","#E84A5F","#F8B195","#F67280","#C06C84"]);function n(){e=d.node().getBoundingClientRect().width-l-s,container.attr("width",e+l+s),svg.attr("width",e+l+s),x.range([0,e]),svg.selectAll(".d3-xaxis").call(xAxis),svg.selectAll(".d3-line").attr("d",line)}d3.csv("../../../app-assets/data/d3/pie/flights.csv",function(t){var e=d3.nest().key(function(t){return t.origin}).entries(t),n=d.selectAll("svg").data(e).enter().append("svg").attr("width",2*(radius+l+s)).attr("height",2*(radius+l+s)).append("g").attr("transform","translate("+(radius+l+s)+","+(radius+l+s)+")"),r=d3.svg.arc().innerRadius(radius/2).outerRadius(radius),a=d3.layout.pie().value(function(t){return+t.count}).sort(function(t,e){return e.count-t.count});n.append("text").attr("dy",".35em").style("text-anchor","middle").style("font-weight",500).text(function(t){return t.key});var i=n.selectAll("g").data(function(t){return a(t.values)}).enter().append("g").attr("class","d3-arc");i.append("path").attr("d",r).style("stroke","#fff").style("fill",function(t){return u(t.data.carrier)}).append("title").text(function(t){return t.data.carrier+": "+t.data.count}),i.filter(function(t){return.2<t.endAngle-t.startAngle}).append("text").attr("dy",".35em").attr("transform",function(t){return"translate("+r.centroid(t)+")rotate("+(90<(n=90*((e=t).startAngle+e.endAngle)/Math.PI-90)?n-180:n)+")";var e,n}).style("fill","#fff").style("font-size",12).style("text-anchor","middle").text(function(t){return t.data.carrier})}),$(window).on("resize",n),$(".menu-toggle").on("click",n)});